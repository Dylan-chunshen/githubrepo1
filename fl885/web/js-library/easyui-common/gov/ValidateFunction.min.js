var monthDaysConsts=new Array(31,28,31,30,31,30,31,31,30,31,30,31);function getDate(d,f){var c=f,b,a;b=/MM/gi;a=""+(d.getMonth()+1);if(a.length==1){a="0"+a}c=c.replace(b,a);b=/DD/gi;a=""+d.getDate();if(a.length==1){a="0"+a}c=c.replace(b,a);b=/YYYY/gi;c=c.replace(b,d.getYear());b=/HH/gi;c=c.replace(b,d.getHours());b=/MI/gi;c=c.replace(b,d.getMinutes());b=/SS/gi;c=c.replace(b,d.getSeconds());b=/MS/gi;c=c.replace(b,d.getMilliseconds());return(c)}function getToday(b){var a=new Date();return getDate(a,b)}function getCurrentMonthBegin(b){var a=new Date();a.setDate(1);return getDate(a,b)}function getCurrentMonthEnd(d){var c=new Date();var b=c.getYear();var a=c.getMonth()+1;if(a!=2){c.setDate(monthDaysConsts[a])}else{if((b%4==0&&b%100!=0)||b%400==0){c.setDate(29)}else{c.setDate(28)}}return getDate(c,d)}function getCurrentWeekBegin(c){var b=new Date();var a=b.getDay();var d=0;switch(a){case 0:d=6;break;case 1:d=0;break;case 2:d=1;break;case 3:d=2;break;case 4:d=3;break;case 5:d=4;break;case 6:d=5;break}b.setDate(b.getDate()-d);return getDate(b,c)}function getCurrentWeekEnd(c){var b=new Date();var a=b.getDay();var d=0;switch(a){case 0:d=0;break;case 1:d=6;break;case 2:d=5;break;case 3:d=4;break;case 4:d=3;break;case 5:d=2;break;case 6:d=1;break}b.setDate(b.getDate()+d);return getDate(b,c)}function getTimeStamp(){return getToday("YYYYMMDDHHMISSMS")}function focusObj(d){try{d.select();d.focus()}catch(b){var a=d;try{while(a!=null){if(a.style.display=="none"){a.style.display=""}a=a.parentElement}d.focus()}catch(c){}}}function message(a,b){if(a.displayName!=null&&a.displayName!=undefined){alert('"'+a.displayName+'"'+b+"！")}else{alert("值"+b+"！")}}function errorMessage(b,c,a){message(b,c);if(a){focusObj(b)}}function validForm2(f,g){var c=f.getElementsByTagName("input");for(var d=0;d<c.length;d++){if(!validValue(c[d],true)){return false}}var b=f.getElementsByTagName("textarea");for(var d=0;d<b.length;d++){if(!validValue(b[d],true)){return false}}var a=f.getElementsByTagName("select");for(var d=0;d<a.length;d++){if(!validValue(a[d],true)){return false}}return true}function validForm(d,f){var c=$(".validatebox-text",$(d));for(var b=0;b<c.length;b++){if(!validValue(c[b],true)){return false}}var a=$(".easyui-combotree",$(d));for(var b=0;b<a.length;b++){if(!validEnableBlank(a[b],f)){return false}}return true}function validValue(b,a){if(b.tagName=="INPUT"){if(b.style.display!="none"&&b.readonly!="true"){if(b.type=="text"){if(!validEnableBlank(b,a)){return false}if(!validMaxLength(b,a)){return false}if(!validMinLength(b,a)){return false}if(!validMaxValue(b,a)){return false}if(!validMinValue(b,a)){return false}if(b.validate_type=="int"){if(!validInteger(b,a)){return false}}if(b.validate_type=="float"){if(!validFloat(b,a)){return false}}if(b.validate_type=="emailAddress"){if(!validEmail(b,a)){return false}}if(b.validate_type=="date"){if(!validDate(b,a)){return false}}if(b.validate_type=="dateEx"){if(!validDateEx(b,a)){return false}}}if(b.type=="checkbox"){if(!validCheckBoxEnableBlank(b,a)){return false}}}}if(b.tagName=="TEXTAREA"){if(b.style.display!="none"&&b.readonly!="true"){if(!validEnableBlank(b,a)){return false}if(!validMaxLength(b,a)){return false}if(!validMinLength(b,a)){return false}}}if(b.tagName=="SELECT"){if(b.style.display!="none"&&b.readonly!="true"){if(!validEnableBlank(b,a)){return false}}}return true}function validCheckBoxEnableBlank(c,b){if(c.enable_blank=="true"||c.enable_blank==undefined){return true}for(var a=0;c.name!=""&&a<document.getElementsByName(c.name).length;a++){if(document.getElementsByName(c.name).item(a).checked){return true}}errorMessage(c,"不能为空",b);return false}function validEnableBlank(b,a){var c=trimString(b.value);if(b.enable_blank=="false"&&c==""){b.value=c;errorMessage(b,"不能为空",a);return false}return true}function validMaxLength(b,a){if(b.max_length>0&&b.value!=""&&b.value.replace(/[^\x00-\xff]/g,"aa").length>b.max_length){errorMessage(b,"长度不能大于"+b.max_length,a);return false}return true}function validMinLength(b,a){if(b.min_length>0&&b.value!=""&&b.value.replace(/[^\x00-\xff]/g,"aa").length<b.min_length){errorMessage(b,"长度不能小于"+b.min_length,a);return false}return true}function validMaxValue(obj,force){if(!isNaN(obj.value)&&!isNaN(obj.max_value)){if(obj.max_value&&obj.value!=""&&parseInt(obj.value)>parseInt(obj.max_value)){errorMessage(obj,"不能大于"+obj.max_value,force);return false}}else{try{if(obj.max_value&&obj.max_value!=""&&obj.value!=""&&eval("document.all."+obj.max_value)&&eval("document.all."+obj.max_value+".value")!=""){var maxObj=eval("document.all."+obj.max_value);if(obj.value>maxObj.value){errorMessage(obj,"不能大于"+maxObj.displayName,force);return false}}}catch(e){}}return true}function validMinValue(obj,force){if(!isNaN(obj.value)&&!isNaN(obj.min_value)){if(obj.min_value&&obj.value!=""&&parseInt(obj.value)<parseInt(obj.min_value)){errorMessage(obj,"不能小于"+obj.min_value,force);return false}}else{try{if(obj.min_value&&obj.min_value!=""&&obj.value!=""&&eval("document.all."+obj.min_value)&&eval("document.all."+obj.min_value+".value")!=""){var minObj=eval("document.all."+obj.min_value);if(obj.value<minObj.value){errorMessage(obj,"不能小于"+minObj.displayName,force);return false}}}catch(e){}}return true}function validInteger(b,c){b.value=trimString(b.value);if(b.value==""){return true}var a=/^-?\d+$/;if(a.test(b.value)){return true}errorMessage(b,"不是整数",c);return false}function validFloat(b,c){if(b.value==""){return true}var a=/^(-?\d+)(\.\d+)?$/;if(a.test(b.value)){return true}errorMessage(b,"不是数字(含小数)",c);return false}function validEmail(b,c){b.value=trimString(b.value);if(b.value==""){return true}var a=/^[_\.a-zA-Z0-9]+@([_a-zA-Z0-9]+\.)+[a-zA-Z0-9]{2,4}$/;if(a.test(b.value)){return true}errorMessage(b,"不是电子邮件地址",c);return false}function validDate(c,f){c.value=trimString(c.value);if(c.value==""){return true}var a=/^(\d{1,4})(-|\/|\.)(\d{1,2})\2(\d{1,2})$/;var b=c.value.substring(0,10).match(a);if(b!=null){var g=new Date(b[1],b[3]-1,b[4]);if(g.getFullYear()==b[1]&&g.getMonth()==b[3]-1&&g.getDate()==b[4]){return true}}errorMessage(c,"不是合法的日期格式",f);return false}function validDateEx(c,f){c.value=trimString(c.value);if(c.value==""){return true}if(c.value.length==10){var a=/^(\d{1,4})(-|\/|\.)(\d{1,2})\2(\d{1,2})$/;var b=c.value.substring(0,10).match(a);if(b[3]==0){return true}if(b[4]==0){return true}if(b!=null){var g=new Date(b[1],b[3]-1,b[4]);if(g.getFullYear()==b[1]&&g.getMonth()==b[3]-1&&g.getDate()==b[4]){return true}}}errorMessage(c,"不是合法的日期格式",f);return false}function trimString(a){if(a==""){return""}for(i=0;i<a.length;i++){if(a.charAt(i)!=" "&&a.charAt(i)!="\t"){break}}strResult=a.substr(i);for(i=strResult.length-1;i>=0;i--){if(strResult.charAt(i)!=" "&&strResult.charAt(i)!="\t"){break}}strResult=strResult.substring(0,i+1);return strResult}function valueIsNum(c){var g="0123456789";var b=c.value;var f=true;var a=0;var d="";for(i=0;i<b.length;i++){ch=b.charAt(i);for(j=0;j<g.length;j++){if(ch==g.charAt(j)){break}}if(j==g.length){f=false;break}if(ch!=","){d+=ch}}if(!f){return(false)}return true}function getSingleQuoteValue(b){var d=184;var c=220;if(3<=getSingleQuoteValue.arguments.length){d=getSingleQuoteValue.arguments[1];c=getSingleQuoteValue.arguments[2]}value=singleQuote(b,d,c);try{if(value){var g,a;g=value;a=g.split("<<!--");sName=a[0];sCode=a[0];if(a.length>1){sName=a[1]}event.srcElement.parentElement.parentElement.children(0).children(0).value=sCode;event.srcElement.parentElement.parentElement.children(0).children(1).value=sName}}catch(f){}}function setSingleQuoteValue(b){try{if(b){var d,a;d=b;a=d.split("<<!--");sName=a[0];sCode=a[0];if(a.length>1){sName=a[1]}event.srcElement.parentElement.parentElement.children(0).children(0).value=sCode;event.srcElement.parentElement.parentElement.children(0).children(1).value=sName}}catch(c){}}function singleQuote(a,b,c){tmpLeft=getIEPosX(event.srcElement)+event.srcElement.offsetWidth+window.screenLeft;tmpTop=getIEPosY(event.srcElement)+window.screenTop-document.body.scrollTop;tmpValue=window.showModalDialog(a,"","dialogLeft:"+tmpLeft+";dialogTop:"+tmpTop+";dialogWidth:"+b+"px;dialogHeight:"+c+"px;scroll:0;status:0;help:0;");if(tmpValue){return tmpValue}else{return""}}function getIEPosX(a){return getIEPos(a,"Left")}function getIEPosY(a){return getIEPos(a,"Top")}function getIEPos(a,b){iPos=0;while(a!=null){iPos+=a["offset"+b];a=a.offsetParent}return iPos}function setInputboxValue(c){var b=document.getElementsByName(c).item(0);b.value="";for(var a=0;a<document.getElementsByName(event.srcElement.name).length;a++){if(document.getElementsByName(event.srcElement.name).item(a).checked){b.value+="1"}else{b.value+=b.fill_char}}if(b.enable_blank=="true"&&b.value.indexOf("1")==-1){b.value=""}}function returnCheckbox(){event.srcElement.checked=!event.srcElement.checked}function keyDownOfSingleQuote(){if(event.keyCode==46){event.srcElement.value="";try{event.srcElement.parentElement.children(0).value=""}catch(a){}}else{if(event.keyCode==13||event.keyCode==9){return}}}function openwindowwithoutbar(d,b){var a=top.screenTop;var c;if(openwindowwithoutbar.arguments.length>=4){sWidth=openwindowwithoutbar.arguments[2];sHeight=openwindowwithoutbar.arguments[3]}else{sWidth=screen.availWidth-10-a;if(sWidth>750){sWidth=750}sHeight=screen.availHeight-30-a}var c;sFeature="left="+a+",top="+a+",Width="+sWidth+",Height="+sHeight+",toolbar=no,status=no,scrollbars=yes,location=no,menubar=no,resizable=yes";window.open(d,b,sFeature,true)}function openwindowwithoutbar_notuse(f,b,g,c){var a=top.screenTop;var d;sFeature="left="+a+",top="+a+",Width="+g+",Height="+c+",toolbar=no,status=no,scrollbars=yes,location=no,menubar=no,resizable=yes";window.open(f,b,sFeature,true)}function openwindowatdetail(b,a){document.all.detailFrame.src=b;if(window.location.href.indexOf("#resultFrameJumpTag")==-1){window.navigate(window.location.href+"#resultFrameJumpTag")}else{window.navigate(window.location.href)}}function closeWindow(b,a){top.close()}function closeWindow(){top.close()}function unionValidFunc(m){var b=document.getElementsByName(m);for(var g=0;g<b.length;g++){var d="";var h="";for(var f=0;f<b[g].length;f++){var a=document.getElementsByName(b[g].options(f).value);for(var l=0;l<a.length;l++){if((a[l].tagName=="INPUT"&&a[l].type!="radio"&&a[l].type!="checkbox")||a[l].tagName=="SELECT"){d+=a[l].value}if(a[l].tagName=="INPUT"&&a[l].type=="checkbox"){for(var c=0;c<document.getElementsByName(b[g].options(f).value).length;c++){if(document.getElementsByName(b[g].options(f).value).item(c).checked){d+=document.getElementsByName(b[g].options(f).value).item(c).value}}}}if(b[g].options(f).text!=""){h+='"'+b[g].options(f).text+'"、'}}h=h.substring(0,h.length-1);if(d==""){alert(h+",至少有一个不能为空！");return false}}return true}function splitStr(objName){obj=eval("document.all."+objName);if(obj!=null&&obj.value.indexOf(" ")>-1){obj.value=obj.value.substring(0,obj.value.indexOf(" "))}}function replaceSexCode(objName){obj=eval("document.all."+objName);if(obj!=null){if(obj.value=="男"){obj.value="1"}else{if(obj.value=="女"){obj.value="2"}else{obj.value=""}}}}function onlyCheckOne(){var b=event.srcElement.parentElement.getElementsByTagName("INPUT");for(var a=0;a<b.length;a++){if(b.item(a)!=event.srcElement&&b.item(a).type=="checkbox"&&b.item(a).name==event.srcElement.name){b.item(a).checked=false}}}function appendDynamicOptions(){var c=",";if(appendDynamicOptions.arguments.length>0){c=appendDynamicOptions.arguments[0]}objDynamicOptions=event.srcElement;objTextarea=event.srcElement.parentElement.parentElement.parentElement.firstChild.firstChild.firstChild;if(objDynamicOptions.selectedIndex>=0){if(objTextarea.value.substring(objTextarea.value.length-1)==c){objTextarea.value+=objDynamicOptions.options[objDynamicOptions.selectedIndex].text}else{if(objTextarea.value!=""){objTextarea.value+=c+objDynamicOptions.options[objDynamicOptions.selectedIndex].text}else{objTextarea.value+=objDynamicOptions.options[objDynamicOptions.selectedIndex].text}}try{var a=document.createEventObject();a.reason=99;objTextarea.fireEvent("onchange",a)}catch(b){}}window.event.cancelBubble=true}function getFullOptionsObject(a){objOptions=a.parentElement.lastChild.getElementsByTagName("SELECT")[0];return objOptions}function showDynamicOptions(){bDisplayAll=false;if(event.srcElement.tagName=="IMG"){objInput=event.srcElement.parentElement.previousSibling.firstChild.firstChild.nextSibling;bDisplayAll=true}else{objInput=event.srcElement;if(showDynamicOptions.arguments.length>0){if(showDynamicOptions.arguments[0]=="all"){bDisplayAll=true}}}objValue=objInput.previousSibling;objOptions=objInput.parentElement.lastChild.getElementsByTagName("SELECT")[0];objDynamicOptions=objInput.parentElement.lastChild.previousSibling.firstChild;if(event.srcElement.tagName!="IMG"){if(event.keyCode==27){hiddenDynamicOptions(objDynamicOptions);return}}if(event.srcElement.tagName!="IMG"){if(event.keyCode==13&&objDynamicOptions.style.display==""){hiddenDynamicOptions(objDynamicOptions);return}}else{if(objDynamicOptions.style.display==""){objDynamicOptions.style.display="none";objDynamicOptions.parentElement.style.display="none";return}}objDynamicOptions.length=0;var c=objOptions.length;var d=0;if(!bDisplayAll){for(i=0;i<c;i++){var f=objOptions.options[i].value;var a=objOptions.options[i].text;if(f.indexOf(objInput.value)>=0||a.indexOf(objInput.value)>=0){var b=objDynamicOptions.add(new Option(objOptions.options[i].text,objOptions.options[i].value));if(objInput.value!=""&&(objOptions.options[i].value==objInput.value||objOptions.options[i].text==objInput.value)){objDynamicOptions.options[objDynamicOptions.length-1].selected=true;objInput.value=objOptions.options[i].text;objValue.value=objOptions.options[i].value}else{objDynamicOptions.options[objDynamicOptions.length-1].selected=false}d++}}}if(d<=0){for(i=0;i<c;i++){objDynamicOptions.add(new Option(objOptions.options[i].text,objOptions.options[i].value));d++}objDynamicOptions.selectedIndex=-1}objDynamicOptions.size=(d>1)?Math.min(d,10):2;if(d>0){objDynamicOptions.style.display="";objDynamicOptions.parentElement.style.display=""}else{objDynamicOptions.style.display="none";objDynamicOptions.parentElement.style.display="none"}window.event.cancelBubble=true}function enterDynamicOptions(){objInput=event.srcElement;objValue=event.srcElement.previousSibling;objDynamicOptions=event.srcElement.parentElement.lastChild.previousSibling.firstChild;e=event.keyCode;if(objDynamicOptions.style.display!="none"){if(e==13){if(objDynamicOptions.selectedIndex>=0){objInput.value=objDynamicOptions.options[objDynamicOptions.selectedIndex].text;objValue.value=objDynamicOptions.options[objDynamicOptions.selectedIndex].value}}if(e==40){objDynamicOptions.focus()}}}function checkDynamicOptions(c,a){objValue=c.previousSibling;objDynamicOptions=c.parentElement.lastChild.previousSibling.firstChild;objOptions=c.parentElement.lastChild.getElementsByTagName("SELECT")[0];if(objDynamicOptions==document.activeElement){return false}if(a!=true){return true}var b=objOptions.length;for(i=0;i<b;i++){if(c.value!=""&&(objOptions.options[i].value==c.value||objOptions.options[i].text==c.value)){c.value=objOptions.options[i].text;objValue.value=objOptions.options[i].value;return true}}c.value="";objValue.value="";return true}function selectDynamicOptions(){objDynamicOptions=event.srcElement;objInput=event.srcElement.parentElement.parentElement.firstChild.nextSibling;objValue=event.srcElement.parentElement.parentElement.firstChild;if(objDynamicOptions.selectedIndex>=0){objInput.value=objDynamicOptions.options[objDynamicOptions.selectedIndex].text;objValue.value=objDynamicOptions.options[objDynamicOptions.selectedIndex].value;hiddenDynamicOptions(objDynamicOptions)}try{var a=document.createEventObject();objInput.fireEvent("onchange",a)}catch(b){}window.event.cancelBubble=true}function hiddenDynamicOptions(a){a.style.display="none";a.parentElement.style.display="none"}function hiddenAllDynamicOptions(){var a=document.getElementsByTagName("SELECT");for(i=0;i<a.length;i++){if(a[i].dynamicOptions=="yes"){a[i].style.display="none";a[i].parentElement.style.display="none"}}}document.onclick=function(){hiddenAllDynamicOptions()};function adjustPageSizeDisplay(){try{var d=location.href;var b;b=/wadPageSize=\d*/i;var a=d.match(b);if(a!=null){a=d.substring(a.index+12,a.lastIndex);a=a.replace(/\D/g,"");if(document.all.wadDisplayTagPageSize.length==undefined){document.all.wadDisplayTagPageSize.value=a}else{for(i=0;i<document.all.wadDisplayTagPageSize.length;i++){document.all.wadDisplayTagPageSize[i].value=a}}}}catch(c){}}function gotoDisplayTagSpecOfPage(k,g,a){var m=event.srcElement;var c="";var h="";var d=10;while(d>0){if(m.type=="text"){if(m.id=="wadDisplayTagPageSize"){h=m}else{c=m}}if(c.type=="text"){break}m=m.previousSibling;d--}var b="";if(h.type=="text"){h.value=h.value.replace(/\D/g,"");pagesize=h.value;if(pagesize!=""){if(valueIsNum(h)){pagesize=parseInt(pagesize,10);oldpagesize="";var n;n=/wadPageSize=\d*/i;var f=k.match(n);if(f!=null){oldpagesize=k.substring(f.index+12,f.lastIndex)}oldpagesize=oldpagesize.replace(/\D/g,"");oldpagesize=parseInt(oldpagesize,10);if(pagesize>0&&oldpagesize!=pagesize){n=/wadPageSize=\d*/g;b=k.replace(n,"wadPageSize="+pagesize);if(b==k){if(k.indexOf("?")){b=k+"&wadPageSize="+pagesize}else{b=k+"?wadPageSize="+pagesize}}n=/wadCurrentPage=\d*/g;b=b.replace(n,"wadCurrentPage=1");location.href=b;return}}}}if(c.type=="text"){c.value=c.value.replace(/\D/g,"");gotopage=c.value;if(gotopage!=""){if(valueIsNum(c)){gotopage=parseInt(gotopage,10);if(gotopage==0){gotopage=1}a=a.replace(/\D/g,"");a=parseInt(a);var l=gotopage<a?gotopage:a;var n;n=/wadCurrentPage=\d*/g;b=k.replace(n,"wadCurrentPage="+l);location.href=b}}}}function checkAll(b){var c=document.getElementsByName(b);for(var a=0;a<c.length;a++){c.item(a).checked=event.srcElement.checked}}function getLinkageValue(d,b){var c=d.value;var k=d.parentElement.firstChild.value;var n=document.all(b);var f=n.parentElement.firstChild;var a=n.parentElement.lastChild.firstChild;var g=n.parentElement.parentElement.lastChild;n.value="";f.value="";a.options.length=0;if(c==""){k=""}if(k!=null&&k!=""){for(var h=0;h<g.options.length;h++){var m=g.options[h].text;if(m.indexOf(k)==0&&m.substring(0,m.indexOf(":"))==k){var l=new Option();if((g.options[h].value).indexOf(":")!=-1){l.value=(g.options[h].value).substring((g.options[h].value).indexOf(":")+1)}else{l.value=g.options[h].value}l.text=(g.options[h].text).substring((g.options[h].text).indexOf(":")+1);a.options[a.options.length]=l}}}}function getLinkageValue_CommonSelect(c,a){var b=c.options[c.selectedIndex].text;var d=c.value;var k=document.all(a);var l=k.parentElement.firstChild.nextSibling;k.options.length=0;var h=new Option();h.value="";h.text="请选择";k.options[k.options.length]=h;if(d!=""){for(var f=0;f<l.options.length;f++){var g=l.options[f].text;if(g.indexOf(d)==0&&g.substring(g.indexOf(":"))==d){var h=new Option();if((hiddenValueObj.options[f].value).indexOf(":")!=-1){h.value=(l.options[f].value).substring((l.options[f].value).indexOf(":")+1)}else{h.value=l.options[f].value}h.text=(l.options[f].text).substring((l.options[f].text).indexOf(":")+1);k.options[k.options.length]=h}}}};